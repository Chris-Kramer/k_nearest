import base64
eval(compile(base64.b64decode(b'aW1wb3J0IHJlCgoiIiIKQSBtb2R1bGUgZm9yIG1hbmFnaW5nIGEgcGhvbmUgYm9vay4KIiIiCgpkZWYgaXNfcGhvbmVfbnVtYmVyKG51bWJlcik6CiAgICAiIiIKICAgIENoZWNrcyBpZiB0aGUgYXJndW1lbnQgaXMgYW4gOC1kaWdpdCBwaG9uZSBudW1iZXIuCgogICAgPj4+IGlzX3Bob25lX251bWJlcignMTIzNDU2NzgnKQogICAgVHJ1ZQoKICAgID4+PiBpc19waG9uZV9udW1iZXIoJzEyIDM0IDU2IDc4JykKICAgIFRydWUKCiAgICA+Pj4gaXNfcGhvbmVfbnVtYmVyKCcxMjM0IDU2NzgnKQogICAgVHJ1ZQogICAgIiIiCiAgICByZXR1cm4gKHR5cGUobnVtYmVyKSBpcyBzdHIpIGFuZCBib29sKHJlLm1hdGNoKHIiKFswLTldezJ9KFxzKikpezR9IixudW1iZXIpKQoKZGVmIGZvcm1hdF9waG9uZV9udW1iZXIobnVtYmVyKToKICAgIGdyb3VwID0gW10KICAgIGZvcm1hdHRlZCA9IFtdCiAgICBmb3IgYyBpbiBudW1iZXI6CiAgICAgICAgaWYgYy5pc251bWVyaWMoKToKICAgICAgICAgICAgZ3JvdXAuYXBwZW5kKGMpCiAgICAgICAgICAgIGlmIGxlbihncm91cCkgPT0gMjoKICAgICAgICAgICAgICAgIGZvcm1hdHRlZC5hcHBlbmQoJycuam9pbihncm91cCkpCiAgICAgICAgICAgICAgICBncm91cCA9IFtdCiAgICByZXR1cm4gJyAnLmpvaW4oZm9ybWF0dGVkKQoKZGVmIGdldChuYW1lKToKICAgICIiIgogICAgUmV0dXJucyB0aGUgY29udGFjdCBpbmZvcm1hdGlvbiBmb3IgdGhlIGdpdmVuIG5hbWUsIGlmIHByZXNlbnQuCgogICAgUmFpc2VzOiBDb250YWN0Tm90Rm91bmRFcnJvciBpZiB0aGVyZSBpcyBubyBjb250YWN0IGluZm9ybWF0aW9uIGZvciB0aGUgZ2l2ZW4gbmFtZS4KICAgICIiIgogICAgaWYgX2lzX3ByZXNlbnQobmFtZSk6CiAgICAgICAgcmV0dXJuIF9jb250YWN0c1tuYW1lXQogICAgZWxzZToKICAgICAgICByYWlzZSBDb250YWN0Tm90Rm91bmRFcnJvcihuYW1lKQoKZGVmIGFkZChuYW1lLHBob25lKToKICAgICIiIgogICAgQWRkIHRoZSBjb250YWN0IGluZm9ybWF0aW9uIGZvciB0aGUgZ2l2ZW4gbmFtZSwgaWYgbm90IHByZXNlbnQuCgogICAgUmFpc2VzOiBEdXBsaWNhdGVDb250YWN0RXJyb3IgaWYgdGhlcmUgaXMgYWxyZWFkeSBhIGNvbnRhY3QgaW5mb3JtYXRpb24gZm9yIHRoZSBnaXZlbiBuYW1lLgogICAgIiIiCiAgICBpZiBfaXNfcHJlc2VudChuYW1lKToKICAgICAgICByYWlzZSBEdXBsaWNhdGVDb250YWN0RXJyb3IobmFtZSkKICAgIGVsc2U6CiAgICAgICAgX2FkZF9vcl91cGRhdGUobmFtZSxwaG9uZSkKCmRlZiB1cGRhdGUobmFtZSxwaG9uZSk6CiAgICAiIiIKICAgIFVwZGF0ZXMgdGhlIGNvbnRhY3QgaW5mb3JtYXRpb24gZm9yIHRoZSBnaXZlbiBuYW1lLCBpZiBwcmVzZW50LgoKICAgIFJhaXNlczogQ29udGFjdE5vdEZvdW5kRXJyb3IgaWYgdGhlcmUgaXMgbm8gY29udGFjdCBpbmZvcm1hdGlvbiBmb3IgdGhlIGdpdmVuIG5hbWUuCiAgICAiIiIKICAgIGlmIF9pc19wcmVzZW50KG5hbWUpOgogICAgICAgIF9hZGRfb3JfdXBkYXRlKG5hbWUscGhvbmUpCiAgICBlbHNlOgogICAgICAgIHJhaXNlIENvbnRhY3ROb3RGb3VuZEVycm9yKG5hbWUpCgpkZWYgX2FkZF9vcl91cGRhdGUobmFtZSxwaG9uZSk6CiAgICAiIiIKICAgIEFkZCBvciB0aGUgY29udGFjdCBpbmZvcm1hdGlvbiBmb3IgdGhlIGdpdmVuIG5hbWUuCgogICAgUmFpc2VzOiBUeXBlRXJyb3IgaWYgcGhvbmUgaXMgbm90IGEgc3RyaW5nIGFuZAogICAgVmFsdWVFcnJvciBpZiBwaG9uZSBpcyBub3QgaW4gOC1kaWdpdCBmb3JtYXQuCiAgICAiIiIKICAgIGlmIGlzX3Bob25lX251bWJlcihwaG9uZSk6CiAgICAgICAgX2NvbnRhY3RzW25hbWVdID0gZm9ybWF0X3Bob25lX251bWJlcihwaG9uZSkKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmJ3twaG9uZSFyfSBpcyBub3QgaW4gOC1kaWdpdCBmb3JtYXQuJykKCmRlZiBfaXNfcHJlc2VudChuYW1lKToKICAgICIiIgogICAgUmV0dXJucyB3aGV0aGVyIHRoZXJlIGlzIGEgY29udGFjdCBmb3IgdGhlIGdpdmVuIG5hbWUuCiAgICAiIiIKICAgIHJldHVybiBuYW1lIGluIF9jb250YWN0cwoKCmNsYXNzIENvbnRhY3ROb3RGb3VuZEVycm9yKEV4Y2VwdGlvbik6CiAgICAiIiIKICAgIEV4Y2VwdGlvbiByYWlzZWQgd2hlbiBhIGNvbnRhY3QgaXMgbm90IGZvdW5kLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHN1cGVyKCkuX19pbml0X18oIm5vIGNvbnRhY3QgaW5mb3JtYXRpb24gZm9yICd7fScuIi5mb3JtYXQobmFtZSkpCgpjbGFzcyBEdXBsaWNhdGVDb250YWN0RXJyb3IoRXhjZXB0aW9uKToKICAgICIiIgogICAgRXhjZXB0aW9uIHJhaXNlZCB3aGVuIGEgY29udGFjdCB3aXRoIHRoZSBzYW1lIG5hbWUgaXMgYWxyZWFkeSBwcmVzZW50LgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHN1cGVyKCkuX19pbml0X18oImNvbnRhY3QgaW5mb3JtYXRpb24gZm9yICd7fScgYWxyZWFkeSBwcmVzZW50LiIuZm9ybWF0KG5hbWUpKQoKX2NvbnRhY3RzID0ge30K'),'<string>','exec'))