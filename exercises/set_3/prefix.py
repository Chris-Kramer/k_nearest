import base64
eval(compile(base64.b64decode(b'IiIiClRoaXMgbW9kdWxlIHByb3ZpZGVzIGZ1bmN0aW9ucyBmb3IgZXZhbHVhdGluZyBhbmQgdmFsaWRhdGluZyBhcml0aG1ldGljCmV4cHJlc3Npb25zIGluIHByZWZpeCBub3RhdGlvbi4gSW4gcHJlZml4IG5vdGF0aW9uIG9wZXJhbmRzIGZvbGxvdyBvcGVyYXRpb25zLgoiIiIKZnJvbSB1dGlscyBpbXBvcnQgVG9rZW5pemVyLCBpc19iaW5hcnlfb3AsIGV2YWxfYmluYXJ5X29wCgpkZWYgZXZhbChleHByZXNzaW9uKToKICAgICIiIgogICAgRXZhbHVhdGVzIGEgdmFsaWQgYXJpdGhtZXRpYyBleHByZXNzaW9uIGluIHByZWZpeCBub3RhdGlvbiBhbmQgcmV0dXJucyB0aGUKICAgIHJlc3VsdC4KCiAgICBQcmVjb25kaXRpb246IGV4cHJlc3Npb24gaXMgdmFsaWQgKHNlZSBmdW5jdGlvbiBpc192YWxpZCkKCiAgICA+Pj4gZXZhbCgrIC0gNCA1IDYpCiAgICA1CiAgICAiIiIKICAgIHRva2VucyA9IFRva2VuaXplcihleHByZXNzaW9uKQogICAgZGVmIGV2YWxfdG9rZW5zKCk6CiAgICAgICAgdG9rZW4gPSB0b2tlbnMubmV4dCgpCiAgICAgICAgaWYgaXNfYmluYXJ5X29wKHRva2VuKToKICAgICAgICAgICAgbCA9IGV2YWxfdG9rZW5zKCkKICAgICAgICAgICAgciA9IGV2YWxfdG9rZW5zKCkKICAgICAgICAgICAgcmV0dXJuIGV2YWxfYmluYXJ5X29wKHRva2VuLGwscikKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gaW50KHRva2VuKQogICAgcmV0dXJuIGV2YWxfdG9rZW5zKCkKCmRlZiBpc192YWxpZChleHByZXNzaW9uKToKICAgICIiIgogICAgUmV0dXJucyBUcnVlIGlmIHRoZSBnaXZlbiBleHByZXNzaW9uIGlzIGEgdmFsaWQgYXJpdGhtZW50aWMgZXhwcmVzc2lvbiBpbgogICAgcHJlZml4IG5vdGF0aW9uLCBGYWxzZSBvdGhlcndpc2UuCgogICAgPj4+IGlzX3ZhbGlkKCsgLSA0IDUgNikKICAgIFRydWUKICAgICIiIgogICAgdG9rZW5zID0gVG9rZW5pemVyKGV4cHJlc3Npb24pCiAgICBkZWYgY2hlY2tfdG9rZW5zKCk6CiAgICAgICAgaWYgdG9rZW5zLmhhc19uZXh0KCk6CiAgICAgICAgICAgIHRva2VuID0gdG9rZW5zLm5leHQoKQogICAgICAgICAgICBpZiBpc19iaW5hcnlfb3AodG9rZW4pOgogICAgICAgICAgICAgICAgbCA9IGNoZWNrX3Rva2VucygpCiAgICAgICAgICAgICAgICByID0gY2hlY2tfdG9rZW5zKCkKICAgICAgICAgICAgICAgIHJldHVybiBsIGFuZCByCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW4uaXNudW1lcmljKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIHJldHVybiBjaGVja190b2tlbnMoKSBhbmQgbm90IHRva2Vucy5oYXNfbmV4dCgpCgpkZWYgdG9fcG9zdGZpeChleHByZXNzaW9uKToKICAgICIiIgogICAgQ29udmVydHMgYSB2YWxpZCBhcml0aG1ldGljIGV4cHJlc3Npb24gaW4gcHJlZml4IG5vdGF0aW9uIHRvIHBvc3RmaXgKICAgIG5vdGF0aW9uIGFuZCByZXR1cm5zIHRoZSByZXN1bHQuCiAgICAiIiIKICAgIHRva2VucyA9IFRva2VuaXplcihleHByZXNzaW9uKQogICAgZGVmIHByb2Nlc3NfdG9rZW5zKCk6CiAgICAgICAgdG9rZW4gPSB0b2tlbnMubmV4dCgpCiAgICAgICAgaWYgaXNfYmluYXJ5X29wKHRva2VuKToKICAgICAgICAgICAgbCA9IHByb2Nlc3NfdG9rZW5zKCkKICAgICAgICAgICAgciA9IHByb2Nlc3NfdG9rZW5zKCkKICAgICAgICAgICAgcmV0dXJuIGwgKyAnICcgKyByICsgJyAnICsgdG9rZW4KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gdG9rZW4KICAgIHJldHVybiBwcm9jZXNzX3Rva2VucygpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgZXhwcmVzc2lvbiA9IGlucHV0KCdFbnRlciB0aGUgYXJpdGhtZXRpYyBleHByZXNzaW9uIHRvIGV2YWx1YXRlOiAnKQogICAgaWYgaXNfdmFsaWQoZXhwcmVzc2lvbik6CiAgICAgICAgcHJpbnQoZXZhbChleHByZXNzaW9uKSkKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoJ1RoZSBleHByZXNzaW9uIGlzIG5vdCBpbiBwcmVmaXggbm90YXRpb24uJykKICAgIGlucHV0KCdQcmVzcyBFbnRlciB0byB0ZXJtaW5hdGUnKQo='),'<string>','exec'))