import base64
eval(compile(base64.b64decode(b'IiIiClRoaXMgbW9kdWxlIHByb3ZpZGVzIGZ1bmN0aW9ucyBmb3IgZXZhbHVhdGluZyBhbmQgdmFsaWRhdGluZyBhcml0aG1ldGljCmV4cHJlc3Npb25zIGluIHBvc3RmaXggbm90YXRpb24uIEluIHBvc3Qgbm90YXRpb24gb3BlcmF0aW9ucyBmb2xsb3cgb3BlcmFuZHMuCiIiIgpmcm9tIHV0aWxzIGltcG9ydCAqCgpkZWYgZXZhbChleHByZXNzaW9uKToKICAgICIiIgogICAgRXZhbHVhdGVzIGEgdmFsaWQgYXJpdGhtZXRpYyBleHByZXNzaW9uIGluIHBvc3RmaXggbm90YXRpb24gYW5kIHJldHVybnMgdGhlCiAgICByZXN1bHQuCgogICAgUHJlY29uZGl0aW9uOiBleHByZXNzaW9uIGlzIHZhbGlkIChzZWUgZnVuY3Rpb24gaXNfdmFsaWQpCgogICAgPj4+IGV2YWwoNCA1IC0gNiArKQogICAgNQogICAgIiIiCiAgICB0b2tlbnMgPSBUb2tlbml6ZXIoZXhwcmVzc2lvbikKICAgIG9wZXJhbmRzID0gU3RhY2soKQogICAgIyBsb29wcyBhcmUgY292ZXJlZCBsYXRlciBpbiB0aGUgY291cnNlCiAgICBkZWYgZXZhbF90b2tlbnMoKToKICAgICAgICBpZiB0b2tlbnMuaGFzX25leHQoKToKICAgICAgICAgICAgdG9rZW4gPSB0b2tlbnMubmV4dCgpCiAgICAgICAgICAgIGlmIGlzX2JpbmFyeV9vcCh0b2tlbik6CiAgICAgICAgICAgICAgICByID0gb3BlcmFuZHMucG9wKCkKICAgICAgICAgICAgICAgIGwgPSBvcGVyYW5kcy5wb3AoKQogICAgICAgICAgICAgICAgb3BlcmFuZHMucHVzaChldmFsX2JpbmFyeV9vcCh0b2tlbixsLHIpKQogICAgICAgICAgICAgICAgZXZhbF90b2tlbnMoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3BlcmFuZHMucHVzaChpbnQodG9rZW4pKQogICAgICAgICAgICAgICAgZXZhbF90b2tlbnMoKQogICAgZXZhbF90b2tlbnMoKQogICAgcmV0dXJuIG9wZXJhbmRzLnBvcCgpCgpkZWYgaXNfdmFsaWQoZXhwcmVzc2lvbik6CiAgICAiIiIKICAgIFJldHVybnMgVHJ1ZSBpZiB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiBpcyBhIHZhbGlkIGFyaXRobWVudGljIGV4cHJlc3Npb24gaW4KICAgIHByZWZpeCBub3RhdGlvbiwgRmFsc2Ugb3RoZXJ3aXNlLgoKICAgID4+PiBpc192YWxpZCgrIC0gNCA1IDYpCiAgICBUcnVlCiAgICAiIiIKICAgIHRva2VucyA9IFRva2VuaXplcihleHByZXNzaW9uKQogICAgIyAnb3BlcmFuZHMnIHNpbXVsYXRlcyB0aGUgc3RhY2sgYnkgdHJhY2tpbmcgaXRzIGhlaWdodAogICAgZGVmIGNoZWNrX3Rva2VucyhvcGVyYW5kcyk6CiAgICAgICAgaWYgdG9rZW5zLmhhc19uZXh0KCk6CiAgICAgICAgICAgIHRva2VuID0gdG9rZW5zLm5leHQoKQogICAgICAgICAgICBpZiBpc19iaW5hcnlfb3AodG9rZW4pIGFuZCBvcGVyYW5kcyA+PSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIGNoZWNrX3Rva2VucyhvcGVyYW5kcyAtIDEpCiAgICAgICAgICAgIGVsaWYgdG9rZW4uaXNudW1lcmljKCk6CiAgICAgICAgICAgICAgICByZXR1cm4gY2hlY2tfdG9rZW5zKG9wZXJhbmRzICsgMSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZSAgICAgICAgICAgIAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBvcGVyYW5kcyA9PSAxCiAgICByZXR1cm4gY2hlY2tfdG9rZW5zKDApCgpkZWYgdG9fcHJlZml4KGV4cHJlc3Npb24pOgogICAgIiIiCiAgICBDb252ZXJ0cyBhIHZhbGlkIGFyaXRobWV0aWMgZXhwcmVzc2lvbiBpbiBwb3N0Zml4IG5vdGF0aW9uIHRvIHByZWZpeAogICAgbm90YXRpb24gYW5kIHJldHVybnMgdGhlIHJlc3VsdC4KICAgICIiIgogICAgdG9rZW5zID0gVG9rZW5pemVyKGV4cHJlc3Npb24pCiAgICBvcGVyYW5kcyA9IFN0YWNrKCkKICAgIGRlZiBwcm9jZXNzX3Rva2VucygpOgogICAgICAgIGlmIHRva2Vucy5oYXNfbmV4dCgpOgogICAgICAgICAgICB0b2tlbiA9IHRva2Vucy5uZXh0KCkKICAgICAgICAgICAgaWYgaXNfYmluYXJ5X29wKHRva2VuKToKICAgICAgICAgICAgICAgIHIgPSBvcGVyYW5kcy5wb3AoKQogICAgICAgICAgICAgICAgbCA9IG9wZXJhbmRzLnBvcCgpCiAgICAgICAgICAgICAgICBvcGVyYW5kcy5wdXNoKHRva2VuICsgJyAnICsgbCArICcgJyArIHIpCiAgICAgICAgICAgICAgICBwcm9jZXNzX3Rva2VucygpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBvcGVyYW5kcy5wdXNoKHRva2VuKQogICAgICAgICAgICAgICAgcHJvY2Vzc190b2tlbnMoKQogICAgcHJvY2Vzc190b2tlbnMoKQogICAgcmV0dXJuIG9wZXJhbmRzLnBvcCgpCiAgICAKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBleHByZXNzaW9uID0gaW5wdXQoJ0VudGVyIHRoZSBhcml0aG1ldGljIGV4cHJlc3Npb24gdG8gZXZhbHVhdGU6ICcpCiAgICBpZiBpc192YWxpZChleHByZXNzaW9uKToKICAgICAgICBwcmludChldmFsKGV4cHJlc3Npb24pKQogICAgZWxzZToKICAgICAgICBwcmludCgnVGhlIGV4cHJlc3Npb24gaXMgbm90IGluIHBvc3RmaXggbm90YXRpb24uJykKICAgIGlucHV0KCdQcmVzcyBFbnRlciB0byB0ZXJtaW5hdGUnKQo='),'<string>','exec'))